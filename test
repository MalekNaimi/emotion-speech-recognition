
import sys
import os
sys.path.append(os.path.join(os.getcwd(),'utility'))

from keras.models import load_model
from utility import functions, globalvars
import librosa
import numpy as np
import train

emotion_classes=['anger','boredom','disgust','anxiety/fear','happiness','sadness','neutral']


def test(data_path:str,model_path:str):
    model=load_model(model_path)
    y_pred = model.predict(train.x_test)
    matrix = confusion_matrix(train.y_test.argmax(axis=1), y_pred.argmax(axis=1))
    ax = sns.heatmap(matrix, annot=True, fmt="d", cmap = 'rocket_r', emotion_classes=['anger','boredom','disgust','anxiety/fear','happiness','sadness','neutral'])
    return matrix
    
    
    
    if __name__ == '__main__':
       model_path='weights_blstm_hyperas_1.h5'
       
